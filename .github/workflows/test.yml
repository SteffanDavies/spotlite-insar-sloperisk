name: Run Slope Risk Analysis (Docker)

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  docker-risk-analysis:
    runs-on: ubuntu-latest

    steps:
    # 1. Download code
    - name: Checkout code
      uses: actions/checkout@v4

    # 2. Build the Docker Image
    - name: Build Docker Image
      run: docker build -t risk-analysis .

    # 3. Run the Container
    # Mounts 'data' so results are saved to the runner
    - name: Run Analysis
      run: docker run -v ${{ github.workspace }}/data:/app/data risk-analysis

    # 4. Upload Results
    - name: Upload Artifacts
      uses: actions/upload-artifact@v4
      if: always()
      with:
        name: risk-analysis-results
        path: |
          data/*.pkl
          data/*.csv
          data/*.tiff
          data/*.png
          data/*.gpkg
